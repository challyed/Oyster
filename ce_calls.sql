copy
(select objectid as id,
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 01 then 1 else 0 end) as "y_2011-01",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 02 then 1 else 0 end) as "y_2011-02",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 03 then 1 else 0 end) as "y_2011-03",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 04 then 1 else 0 end) as "y_2011-04",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 05 then 1 else 0 end) as "y_2011-05",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 06 then 1 else 0 end) as "y_2011-06",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 07 then 1 else 0 end) as "y_2011-07",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 08 then 1 else 0 end) as "y_2011-08",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 09 then 1 else 0 end) as "y_2011-09",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 10 then 1 else 0 end) as "y_2011-10",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 11 then 1 else 0 end) as "y_2011-11",
  sum(case when extract(year from "DateOpened") = 2011 and extract(month from "DateOpened") = 12 then 1 else 0 end) as "y_2011-12",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 01 then 1 else 0 end) as "y_2012-01",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 02 then 1 else 0 end) as "y_2012-02",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 03 then 1 else 0 end) as "y_2012-03",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 04 then 1 else 0 end) as "y_2012-04",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 05 then 1 else 0 end) as "y_2012-05",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 06 then 1 else 0 end) as "y_2012-06",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 07 then 1 else 0 end) as "y_2012-07",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 08 then 1 else 0 end) as "y_2012-08",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 09 then 1 else 0 end) as "y_2012-09",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 10 then 1 else 0 end) as "y_2012-10",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 11 then 1 else 0 end) as "y_2012-11",
  sum(case when extract(year from "DateOpened") = 2012 and extract(month from "DateOpened") = 12 then 1 else 0 end) as "y_2012-12",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 01 then 1 else 0 end) as "y_2013-01",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 02 then 1 else 0 end) as "y_2013-02",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 03 then 1 else 0 end) as "y_2013-03",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 04 then 1 else 0 end) as "y_2013-04",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 05 then 1 else 0 end) as "y_2013-05",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 06 then 1 else 0 end) as "y_2013-06",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 07 then 1 else 0 end) as "y_2013-07",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 08 then 1 else 0 end) as "y_2013-08",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 09 then 1 else 0 end) as "y_2013-09",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 10 then 1 else 0 end) as "y_2013-10",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 11 then 1 else 0 end) as "y_2013-11",
  sum(case when extract(year from "DateOpened") = 2013 and extract(month from "DateOpened") = 12 then 1 else 0 end) as "y_2013-12",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 01 then 1 else 0 end) as "y_2014-01",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 02 then 1 else 0 end) as "y_2014-02",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 03 then 1 else 0 end) as "y_2014-03",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 04 then 1 else 0 end) as "y_2014-04",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 05 then 1 else 0 end) as "y_2014-05",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 06 then 1 else 0 end) as "y_2014-06",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 07 then 1 else 0 end) as "y_2014-07",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 08 then 1 else 0 end) as "y_2014-08",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 09 then 1 else 0 end) as "y_2014-09",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 10 then 1 else 0 end) as "y_2014-10",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 11 then 1 else 0 end) as "y_2014-11",
  sum(case when extract(year from "DateOpened") = 2014 and extract(month from "DateOpened") = 12 then 1 else 0 end) as "y_2014-12"
  from "voting-precincts" v left join ce_calls c ON(st_contains(v.geom, c.geom) AND "CaseType" = 'Nuisance')
  group by objectid
  order by id
) TO STDOUT WITH CSV HEADER;

